---
layout: default
permalink: /server
---

# Сервер
{:.no_toc}

* TOC
{:toc}


## [](#parameters) Системные параметры

Настроить пути конфигурации и архивов можно в файле server.json, расположенном в папке *%ProgramFiles(x86)%\Telecontrol SCADA\bin*.


## [](#console) Запуск в режиме консоли

Сервер может быть запущен в консольном режиме. Для этого следует остановить службу *Telecontrol SCADA Server*, и использовать пиктограмму *Сервер (консоль)* на рабочем столе, либо из меню *Пуск - ОИК Телеконтроль*.

Внимание: при отсутствии у текущего пользователя Windows административных прав работа Сервера может быть нарушена.


## Базы данных

Для хранения событий аудита и последних значений объектов используется Системная БД.

Допустимо создание нескольких исторических БД, куда могут быть включены различные объекты.

Для каждой БД задается глубина хранения данных.

### Местоположение

Местоположение БД определяется системным параметром `history-path`. По умолчанию используется папка *%ProgramData%\Telecontrol\SCADA Server\History*.

Для каждой БД создается собственная подпапка с уникальным идентификатором. Исключением является фиксированное имя *System* системной БД.

### Структура

### Оценка требуемого дискового пространства

Максимальный допустимый размер БД составляет 1 Тб. Для подробностей смотрите [характеристики SQLite](http://sqlite.org/limits.html). Размер страницы БД, создаваемой Сервером, составляет 1 Кб. Максимальное число страниц равно 1073741823.

Размер одной записи измерения составляет менее 100 Б.

Таким образом, ожидаемый размер БД в Мб можно вычислить как: `size = freq * depth / 10000`, где:
- `size` - ожидаемый размер БД в Мб;
- `freq` - частота изменений в день;
- `depth` - глубина (в днях).

Либо, при известном объеме доступного дискового пространства, можно вычислить максимальную глубину в днях: `depth = size * 10000 / freq`.

### Командная строка SQLite

Данный пункт описывает дополнительные возможности администрирования и диагностики. Так как сервер выполняет обслуживание БД в автоматическом режиме, ознакомление с данным пунктом не требуется.

Для прямого доступа к БД можно использовать утилиту командной строки SQLite, устанавливаемую вместе с Сервером. Для вызова командной строки SQLite выполните команду `"%ProgramFiles(x86)%\Telecontrol SCADA\bin\sqlite3.exe" history` из папки БД. Утилита позволяет выполнять запросы SQL и ряд специальных команд. Для информации о списке допустимых команд смотрите [документацию](https://sqlite.org/cli.html).

Примеры:

```
sqlite> pragma page_size;
1024
sqlite> .tables
events      timed_data
sqlite> .schema events
CREATE TABLE events(time INTEGER, change_mask INTEGER, severity INTEGER,
item_id INTEGER, user_id INTEGER, value FLOAT, qualifier INTEGER,
message TEXT, ack_id INTEGER, ack_time INTEGER, ack_user_id INTEGER);
CREATE UNIQUE INDEX events_ack_index ON events(ack_id);
CREATE INDEX events_time_index ON events(time);
sqlite> select count(*) from events;
86
```
